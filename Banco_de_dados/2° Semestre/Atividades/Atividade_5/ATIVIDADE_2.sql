CREATE TABLE FAIXA_IMOVEL(
CDFAIXA INT primary KEY,
NMFAIXA VARCHAR(30),
VLMINIMO DECIMAL(14,2),
VLMAXIMO DECIMAL(14,2)
);

CREATE TABLE ESTADO(
SGESTADO CHAR(2) primary KEY,
NMESTADO VARCHAR(20)
);

CREATE TABLE CIDADE (
CDCIDADE INT,
SGESTADO CHAR(2),
NMCIDADE VARCHAR(20),
primary key (CDCIDADE,SGESTADO)
);

CREATE TABLE BAIRRO(
CDBAIRRO INT,
CDCIDADE INT,
SGESTADO CHAR(2),
NMBAIRRO VARCHAR(20),
primary key (CDBAIRRO,CDCIDADE,SGESTADO)
);

CREATE TABLE COMPRADOR(
CDCOMPRADOR INT PRIMARY KEY,
NMCOMPRADOR VARCHAR(40),
NMENDERECO VARCHAR(40),
NRCPF DECIMAL(11),
NMCIDADE VARCHAR(20),
NMBAIRRO VARCHAR(20),
SGESTADO CHAR(2),
TELEFONE VARCHAR(14),
EMAIL VARCHAR(100)
);

CREATE TABLE VENDEDOR(
CDVENDEDOR INT PRIMARY KEY,
NMVENDEDOR VARCHAR(40),
NMENDERECO VARCHAR(40),
NRCPF DECIMAL(11),
NMCIDADE VARCHAR(20),
NMBAIRRO VARCHAR(20),
SGESTADO CHAR(2),
TELEFONE VARCHAR(14),
EMAIL VARCHAR(100)
);

CREATE TABLE IMOVEL (
  CDIMOVEL INT UNSIGNED NOT NULL AUTO_INCREMENT,
  CDBAIRRO INT,
  CDCIDADE INT,
  SGESTADO CHAR(2),
  CDVENDEDOR INT,
  NMENDEREÇO  VARCHAR(40) NULL,
  NRAREAUTIL DECIMAL(10,2) NULL,
  NRAREATOTAL DECIMAL(10,2) NULL,
  DSIMOVEL VARCHAR(300) NULL,
  VLPRECO DECIMAL(16,2) NULL,
  NROFERTAS INTEGER UNSIGNED NULL,
  STVENDIDO CHAR(1) NULL,
  DTLANCTO DATE NULL,
  IMOVEL_INDICADO INT UNSIGNED NULL,
  primary key (CDIMOVEL),
CONSTRAINT IMOVEL  foreign key (CDBAIRRO,CDCIDADE,SGESTADO) REFERENCES BAIRRO (CDBAIRRO,CDCIDADE,SGESTADO),
CONSTRAINT IMOVEL1 foreign key(CDVENDEDOR) references VENDEDOR (CDVENDEDOR),
CONSTRAINT IMOVEL2 foreign key (IMOVEL_INDICADO) REFERENCES IMOVEL(CDIMOVEL)
);


CREATE TABLE OFERTA(
CDIMOVEL INT UNSIGNED NOT NULL,
CDCOMPRADOR INT,
VLOFERTA DECIMAL(16,2),
DTOFERTA DATE,
primary key (CDIMOVEL, CDCOMPRADOR),
CONSTRAINT OFERTA FOREIGN KEY(CDCOMPRADOR) REFERENCES COMPRADOR(CDCOMPRADOR),
CONSTRAINT OFERTA1 FOREIGN KEY(CDIMOVEL) REFERENCES IMOVEL(CDIMOVEL)
);
  
INSERT INTO ESTADO VALUES
('SP','SÃO PAULO'),
('RJ','RIO DE JANEIRO');

INSERT INTO CIDADE VALUES
(1, 'SP','SÃO PAULO'),
(2,'SP','SANTO ANDRÉ'),
(3,'SP','CAMPINAS'),
(4,'RJ','RIO DE JANEIRO'),
(5,'RJ','NITERÓI');

INSERT INTO BAIRRO VALUES
(1,1,'SP', 'MORUMBI'),
(2,1,'SP', 'JARDINS'),
(3,1,'SP','AEROPORTO'),
(4,2,'RJ','AEROPORTO'),
(5,2,'RJ','FLAMENGO');

INSERT INTO VENDEDOR VALUES
(1,'MARIA DA SILVA','RUA DO GRITO,45',25814736995,'SÃO PAULO','INTERLAGOS','SP',990852512,'MARIA@MAIL.COM'),
(2,'MARCOS ANDRADE','RUA DAS  FIGUEIRAS,124',78945613274,'SANTO ANDRÉ','JARDINS','SP',9748956123,'MARCOS@MAIL.COM'),
(3,'ANDRE CARDOSO','AV, BRASIL,401', 23564798563,'SÃO PAULO','VL OLIMPIA','SP','9785263417','ANDRE@MAIL.COM'),
(4,'TATIANA SOUZA','RUA DO IMPERADOR',45678912365,'RIO DE JANEIRO','COPACABANA','RJ',98745612345,'TATIANE@MAIL.COM');


INSERT INTO IMOVEL (CDIMOVEL,CDVENDEDOR,CDBAIRRO,CDCIDADE,SGESTADO,NMENDEREÇO,NRAREAUTIL,NRAREATOTAL,VLPRECO,DTLANCTO) VALUES
(1,1,1,1,'SP','AL TIETE,3304, AP 101',250,400,180000,'2001-12-05'),
(2,2,1,1,'SP','AV MORUMBI,2230',150,250,135000,'2002-01-15'),
(3,2,4,2,'RJ','R GAL OSORIO, 445 AP 34',250,400,185000,'2002-01-15'),
(4,2,5,2,'RJ','R. D PEDRO I, 882', 120,200,110000,'2002-05-02'),
(5,3,3,1,'SP','AV. RUBENS BERTA,2355',110,200,95000,'2002-10-02'),
(6,4,5,2,'RJ','R GETULIO VARGAS, 552',200,300,99000,'2002-02-10');

INSERT INTO COMPRADOR (CDCOMPRADOR,NMCOMPRADOR,NMENDERECO,EMAIL) VALUES
(1,'EMMANUEL ANTUNES','R,SARAIVA,452','eantunes@mail.com.br'),
(2,'JOANA PEREIRA','AV. PORTUGAL,52','jpereira@mail.com.br'),
(3,'RONALDO CAPELO','R. ESTADO UNIDOS,790','rcapelo@mail.com.br'),
(4,'MANFRED AUGUSTO','AV. BRASIL, 351','magusto@mail.com.br');

INSERT INTO OFERTA (CDCOMPRADOR,CDIMOVEL,VLOFERTA,DTOFERTA) VALUES
(1,1,170000,'2002-01-10'),
(1,3,180000,'2002-01-10'),
(2,4,100000,'2002-02-15'),
(3,1,160000,'2002-05-01'),
(3,2,140000,'2002-02-20');

-- Questão 1
select IMOVEL.CDIMOVEL, IMOVEL.CDVENDEDOR, VENDEDOR.NMVENDEDOR, IMOVEL.SGESTADO FROM IMOVEL
inner join VENDEDOR ON VENDEDOR.CDVENDEDOR = IMOVEL.CDVENDEDOR;


-- Questão 2
select COMPRADOR.CDCOMPRADOR, COMPRADOR.NMCOMPRADOR, OFERTA.CDIMOVEL, OFERTA.VLOFERTA FROM COMPRADOR
inner join OFERTA ON OFERTA.CDCOMPRADOR = COMPRADOR.CDCOMPRADOR;

-- Questão 3
select IMOVEL.CDIMOVEL, IMOVEL.VLPRECO, BAIRRO.NMBAIRRO, IMOVEL.CDVENDEDOR FROM BAIRRO
inner join IMOVEL ON IMOVEL.CDBAIRRO = BAIRRO.CDBAIRRO 
where IMOVEL.CDVENDEDOR = 3;

-- Questão 4
select OFERTA.CDIMOVEL, OFERTA.VLOFERTA FROM OFERTA
inner join IMOVEL on IMOVEL.CDIMOVEL = OFERTA.CDIMOVEL
where VLOFERTA is not null;

-- Questão 5
select IMOVEL.CDIMOVEL, OFERTA.VLOFERTA FROM IMOVEL
left join OFERTA on IMOVEL.CDIMOVEL = OFERTA.CDIMOVEL;

-- Questão 6
select COMPRADOR.CDCOMPRADOR, OFERTA.VLOFERTA from COMPRADOR
inner join OFERTA on COMPRADOR.CDCOMPRADOR = OFERTA.CDCOMPRADOR;

-- Questão 7
select COMPRADOR.CDCOMPRADOR, OFERTA.VLOFERTA from COMPRADOR
left join OFERTA on COMPRADOR.CDCOMPRADOR = OFERTA.CDCOMPRADOR;

-- Questão 8
select NMENDEREÇO, IMOVEL_INDICADO from IMOVEL;

-- Questão 9
select IMOVEL.NMENDEREÇO, IMOVEL.IMOVEL_INDICADO, VENDEDOR.NMVENDEDOR from IMOVEL
inner join VENDEDOR on VENDEDOR.CDVENDEDOR = IMOVEL.CDVENDEDOR;

-- Questão 10
select IMOVEL.NMENDEREÇO, IMOVEL.VLPRECO, BAIRRO.NMBAIRRO from IMOVEL
inner join BAIRRO on IMOVEL.CDBAIRRO = BAIRRO.CDBAIRRO;